pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
-- tortle game jam
-- by david d and joe l

--to do

    --add a baddie
    --give baddie 1 life
    --have baddie delete on death
    --respawn baddie after X seconds

player = nil

function _init()
    
    player = make_player()

end

function _draw()
    
    cls()

    --for debugging sprite animation
	--spr(frame[1], 0,0, frame[2], 2)

    --background
    map(0,0,0,0,16,8)

    --player sprite (pre-animation)
    --spr(1,player.x,player.y,2,2)
    local offset = 0

    if player.flip and player.frame[2] > 2
        then offset = (player.frame[2] - 2)*8
    end

    spr(player.frame[1],player.x-offset,player.y,player.frame[2],2,player.flip)

    --for debugging sprite location for wall detection
    print("x "..player.x)
    print("y "..player.y)

end

function _update()

    player_movement(player)
    player_actions(player)
    player_animations(player)

end

function make_actor(x,y)
    
    local a = {}
    a.x = x
    a.y = y
    a.life = 1

    return a

end

function make_player()
    
    player = make_actor(78,112)
    player.score = 0
    player.flip = false
    
    --First variable is the # of the sprite; Second is the # of sprites wide; Third is the # of frames per animation (the wait between each animation)
    --for player animations
    player.anims = {
        idle = {
            {1, 2, 1}
        },
	    walk = {
		    {1, 2, 4},
		    {33, 2, 4},
		    {35, 2, 4},
		    {33, 2, 4}
	    },
    	sword = {
            {1, 2, 10},
            {3, 2, 3},
            {5, 3, 1},
            {8, 2, 2},
            {3, 2, 1}
	    }
    }

    player.currentAnim = player.anims.idle
    player.frameNum = 1
    player.frame = player.currentAnim[1]
    player.timer = player.currentAnim[1][3]

    return player

end

function player_movement(player)

    local movement = player
    player.currentAnim = player.anims.idle
    
    if (btn(0)) then
        player.x = player.x-1
        player.currentAnim = player.anims.walk
        player.flip = true
    end
    if (btn(1)) then
        player.x = player.x+1
        player.currentAnim = player.anims.walk
        player.flip = false
    end
    if (btn(2)) then
        player.y = player.y-1
        player.currentAnim = player.anims.walk
    end
    if (btn(3)) then
        player.y = player.y+1
        player.currentAnim = player.anims.walk
    end

    if player.y==63
        then player.y = player.y+1
    end
    if player.y==112
        then player.y = player.y-1
    end
    if player.x==-1
        then player.x = player.x+1
    end
    if player.x==113
        then player.x = player.x-1
    end

end

function player_actions(player)

    local actions = player

    if (btn(4)) then
        player.currentAnim = player.anims.sword
    end

end

function player_animations(player)

    if (player.timer <= 0) then
		player.frameNum = (player.frameNum + 1) % #player.currentAnim
		player.frame = player.currentAnim[player.frameNum + 1]
		player.timer = player.frame[3]
	else
		player.timer -= 1
    end

end



__gfx__
00000000000000111100000000000011110000000000001111000000000000000000001111000000000000000000000000000000000000000000000000000000
00000000000001333310000000000133331000000000013333100000000000000000013333100077000000000000000000000000000000000000000000000000
00700700000001375311000000000137531100000000013753110000000000000000013753110770000000000000000000000000000000000000000000000000
00077000000001333331000000000133333100000000013333310000000000000000013333317500000000000000000000000000000000000000000000000000
00077000000014111110000000001411111000000000141111103777777700000000141111175000000000000000000000000000000000000000000000000000
00700700000124400090000000012440009000000001244000937777777777000001244000950000000000000000000000000000000000000000000000000000
00000000000142003099000000014200309900000001420030993077777777770001420030990000000000000000000000000000000000000000000000000000
00000000001444033099000000144403309900000014440330990007777777770014440330990000000000000000000000000000000000000000000000000000
00000000001222333009000000122233300330000012223330090000777777700012223330090000000000000000000000000000000000000000000000000000
00000000001444033559000000144403353330000014440330090000777777700014440335590000000000000000000000000000000000000000000000000000
00000000001444033344000000144403333330000014440333440777777777000014440333440000000000000000000000000000000000000000000000000000
00000000000142073340000000014207334000000001477733777777777700000001420033400000000000000000000000000000000000000000000000000000
00000000000124770040000000012477004000000001240777777777770000000001240000400000000000000000000000000000000000000000000000000000
00000000000017700001000000001770000100000000100000010000000000000000100000010000000000000000000000000000000000000000000000000000
00000000000077011333100000007701133310000000100113331000000000000000100113331000000000000000000000000000000000000000000000000000
00000000000133310133310000013331013331000001333101333100000000000001333101333100000000000000000000000000000000000000000000000000
00000000000000111100000000000011110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000001333310000000000133331000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000001375311000000000137531100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000001333331000000000133333100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000014111110000000001411111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000124400090000000012440009000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000142003099000000014200309900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000001444033099000000144403309900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000001222333009000000122233300900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000001444033559000000144403355900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000001444033344000000144403334400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000142073340000000014207334000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000124770040000000012477004000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000017700001000000001770000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000077011331000000007701133310000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000001333131000000013331013331000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
ddddddddd55555554444444444444444000000000000000002444420000000000000000000000000000000000000000000000000000000000000000000000000
d2255555d55555554f4ff4f44f4ff4f4000000000000000054444445000000000000000000000000000000000000000000000000000000000000000000000000
5dd25555dddddddd0444444004444440000000000000000054ffff45000000000000000000000000000000000000000000000000000000000000000000000000
222d22225555d555000000000004400000000000000000005f2222f5000000000000000000000000000000000000000000000000000000000000000000000000
dddddddd5555d5550000000000044000000000000000000052444425000000000000000000000000000000000000000000000000000000000000000000000000
255555d2dddddddd0000000000044000000000000000000054444445000000000000000000000000000000000000000000000000000000000000000000000000
d225555dd55555550000000000044000000000000000000054ffff45000000000000000000000000000000000000000000000000000000000000000000000000
2dd22222d5555555000000000004400000000000000000005f2222f5000000000000000000000000000000000000000000000000000000000000000000000000
00000000d555555d0000000000044000000000000000000052444425000000000000000000000000000000000000000000000000000000000000000000000000
000000005d5555d50000000000044000000000000000000054444445000000000000000000000000000000000000000000000000000000000000000000000000
000000005d5555d50000000000044000000000000000000054ffff45000000000000000000000000000000000000000000000000000000000000000000000000
00000000d555555d000000000004400000000000000000005f2222f5000000000000000000000000000000000000000000000000000000000000000000000000
00000000d555555d0000000000044000000000000000000052444425000000000000000000000000000000000000000000000000000000000000000000000000
000000005d5555d50000000000044000000000000000000054444445000000000000000000000000000000000000000000000000000000000000000000000000
000000005d5555d50000000000044000000000000000000054ffff45000000000000000000000000000000000000000000000000000000000000000000000000
00000000d555555d000000000004400000000000000000005f2222f5000000000000000000000000000000000000000000000000000000000000000000000000
000000000d5555d00000000000000000000000000000000014444441144444411444444100000000000000000000000000000000000000000000000000000000
00000000d5dddd5d0000000000000000000000000000000001111110211111122111111200000000000000000000000000000000000000000000000000000000
000000005d5555d50000000000000000000000000000000000000000f222222ff222222f00000000000000000000000000000000000000000000000000000000
000000005d5555d50000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000
000000005d5555d50000000000000000000000000000000000000000ffff555fffffffff00000000000000000000000000000000000000000000000000000000
000000005d5555d50000000000000000000000000000000000000000f555ffffffffffff00000000000000000000000000000000000000000000000000000000
00000000d5dddd5d0000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000
000000000d5555d00000000000000000000000000000000000000000ffffffffffffffff00000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000fffffffffffff55fffffffffff4444ff0000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000fffffffffffffffffffffffff442244f0000000000000000000000000000000000000000
00000000000008000000000000000000000000000000000000000000f5f5fffffffffffffffffffff422224f0000000000000000000000000000000000000000
0000000008000d000000000000000000000000000000000000000000ff5ffffffffffffffffffffff422224f0000000000000000000000000000000000000000
0000000008008d000000000000000000000000000000000000000000fffffffffffffffffffffffff444494f0000000000000000000000000000000000000000
000000000dd0ddd00000000000000000000000000000000000000000fffffffffffffffffffffffff422224f0000000000000000000000000000000000000000
00000000ddd0ddd00000000000000000000000000000000000000000fffffffffffffffffffffffff422224f0000000000000000000000000000000000000000
00000000000cc0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000c77c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000cccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000cccc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000007cccc700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000007cccccc70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000007cccccc70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000077777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000098000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8696969696969686000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
a7a8a7a8a7a8a8a7869696969696968600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
b8b9b7b9838283b7a8a7a7a8a8a7a8a800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
b7b8b9ba93a293b9bab7b8b9b7bab9b900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8181818181808181818181818181818100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8181818081818181818180818181818100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8181818181818181818181818181818100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
